<div id="message-history" class="h-[56vh] overflow-y-auto rounded-2xl bg-base-100 p-3 md:p-4">
    {% if messages %}
        <div class="space-y-3">
            {% for message in messages %}
                <div class="chat {% if message.sender == 'user' %}chat-end{% else %}chat-start{% endif %}">
                    <div class="chat-bubble {% if message.sender == 'user' %}chat-bubble-info{% elif message.sender == 'ai' %}chat-bubble-neutral{% else %}chat-bubble-neutral{% endif %}">
                        {{ message.content|linebreaksbr }}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="flex h-full items-center justify-center text-sm text-base-content/60">
            Start the conversation by sending your first message.
        </div>
    {% endif %}
</div>

<script>
(function () {
    const history = document.getElementById("message-history");
    if (!history) return;

    requestAnimationFrame(() => {
        history.scrollTop = history.scrollHeight;
    });
})();
</script>
